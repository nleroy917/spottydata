{"version":3,"sources":["../../../../build/babel/loader/get-config.ts"],"names":["nextDistPath","fileExtensionRegex","getCacheCharacteristics","loaderOptions","source","filename","isServer","pagesDir","isPageFile","startsWith","isNextDist","test","hasModuleExports","indexOf","fileExt","exec","getPlugins","cacheCharacteristics","hasReactRefresh","development","applyCommonJsItem","require","type","reactRefreshItem","skipEnvCheck","noAnonymousDefaultExportItem","pageConfigItem","disallowExportAllItem","transformDefineItem","resolve","nextSsgItem","commonJsItem","filter","Boolean","isJsonFile","isJsFile","getCustomBabelConfig","configFilePath","babelConfigRaw","JSON5","parse","Error","getFreshConfig","target","inputSourceMap","hasJsxRuntime","configFile","addDependency","customConfig","undefined","options","babelrc","cloneInputAst","sourceMaps","sourceMap","sourceFileName","plugins","env","presets","overrides","caller","name","supportsStaticESM","supportsDynamicImport","supportsTopLevelAwait","isDev","Object","defineProperty","enumerable","writable","value","reason","emitWarning","loadedOptions","config","getCacheKey","flags","configCache","Map","getConfig","cacheKey","has","cachedConfig","get","cwd","root","freshConfig","call","set"],"mappings":"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","sourcesContent":["import { readFileSync } from 'fs'\nimport JSON5 from 'next/dist/compiled/json5'\n\nimport { createConfigItem, loadOptions } from 'next/dist/compiled/babel/core'\nimport loadConfig from 'next/dist/compiled/babel/core-lib-config'\n\nimport { NextBabelLoaderOptions, NextJsLoaderContext } from './types'\nimport { consumeIterator } from './util'\n\nconst nextDistPath = /(next[\\\\/]dist[\\\\/]next-server[\\\\/]lib)|(next[\\\\/]dist[\\\\/]client)|(next[\\\\/]dist[\\\\/]pages)/\n\n/**\n * The properties defined here are the conditions with which subsets of inputs\n * can be identified that are able to share a common Babel config.  For example,\n * in dev mode, different transforms must be applied to a source file depending\n * on whether you're compiling for the client or for the server - thus `isServer`\n * is germane.\n *\n * However, these characteristics need not protect against circumstances that\n * will not be encountered in Next.js.  For example, a source file may be\n * transformed differently depending on whether we're doing a production compile\n * or for HMR in dev mode.  However, those two circumstances will never be\n * encountered within the context of a single V8 context (and, thus, shared\n * cache).  Therefore, hasReactRefresh is _not_ germane to caching.\n *\n * NOTE: This approach does not support multiple `.babelrc` files in a\n * single project.  A per-cache-key config will be generated once and,\n * if `.babelrc` is present, that config will be used for any subsequent\n * transformations.\n */\ninterface CharacteristicsGermaneToCaching {\n  isServer: boolean\n  isPageFile: boolean\n  isNextDist: boolean\n  hasModuleExports: boolean\n  fileExt: string\n}\n\nconst fileExtensionRegex = /\\.([a-z]+)$/\nfunction getCacheCharacteristics(\n  loaderOptions: NextBabelLoaderOptions,\n  source: string,\n  filename: string\n): CharacteristicsGermaneToCaching {\n  const { isServer, pagesDir } = loaderOptions\n  const isPageFile = filename.startsWith(pagesDir)\n  const isNextDist = nextDistPath.test(filename)\n  const hasModuleExports = source.indexOf('module.exports') !== -1\n  const fileExt = fileExtensionRegex.exec(filename)?.[1] || 'unknown'\n\n  return {\n    isServer,\n    isPageFile,\n    isNextDist,\n    hasModuleExports,\n    fileExt,\n  }\n}\n\n/**\n * Return an array of Babel plugins, conditioned upon loader options and\n * source file characteristics.\n */\nfunction getPlugins(\n  loaderOptions: NextBabelLoaderOptions,\n  cacheCharacteristics: CharacteristicsGermaneToCaching\n) {\n  const {\n    isServer,\n    isPageFile,\n    isNextDist,\n    hasModuleExports,\n  } = cacheCharacteristics\n\n  const { hasReactRefresh, development } = loaderOptions\n\n  const applyCommonJsItem = hasModuleExports\n    ? createConfigItem(require('../plugins/commonjs'), { type: 'plugin' })\n    : null\n  const reactRefreshItem = hasReactRefresh\n    ? createConfigItem(\n        [require('react-refresh/babel'), { skipEnvCheck: true }],\n        { type: 'plugin' }\n      )\n    : null\n  const noAnonymousDefaultExportItem =\n    hasReactRefresh && !isServer\n      ? createConfigItem(\n          [require('../plugins/no-anonymous-default-export'), {}],\n          { type: 'plugin' }\n        )\n      : null\n  const pageConfigItem =\n    !isServer && isPageFile\n      ? createConfigItem([require('../plugins/next-page-config')], {\n          type: 'plugin',\n        })\n      : null\n  const disallowExportAllItem =\n    !isServer && isPageFile\n      ? createConfigItem(\n          [require('../plugins/next-page-disallow-re-export-all-exports')],\n          { type: 'plugin' }\n        )\n      : null\n  const transformDefineItem = createConfigItem(\n    [\n      require.resolve('next/dist/compiled/babel/plugin-transform-define'),\n      {\n        'process.env.NODE_ENV': development ? 'development' : 'production',\n        'typeof window': isServer ? 'undefined' : 'object',\n        'process.browser': isServer ? false : true,\n      },\n      'next-js-transform-define-instance',\n    ],\n    { type: 'plugin' }\n  )\n  const nextSsgItem =\n    !isServer && isPageFile\n      ? createConfigItem([require.resolve('../plugins/next-ssg-transform')], {\n          type: 'plugin',\n        })\n      : null\n  const commonJsItem = isNextDist\n    ? createConfigItem(\n        require('next/dist/compiled/babel/plugin-transform-modules-commonjs'),\n        { type: 'plugin' }\n      )\n    : null\n\n  return [\n    noAnonymousDefaultExportItem,\n    reactRefreshItem,\n    pageConfigItem,\n    disallowExportAllItem,\n    applyCommonJsItem,\n    transformDefineItem,\n    nextSsgItem,\n    commonJsItem,\n  ].filter(Boolean)\n}\n\nconst isJsonFile = /\\.(json|babelrc)$/\nconst isJsFile = /\\.js$/\n\n/**\n * While this function does block execution while reading from disk, it\n * should not introduce any issues.  The function is only invoked when\n * generating a fresh config, and only a small handful of configs should\n * be generated during compilation.\n */\nfunction getCustomBabelConfig(configFilePath: string) {\n  if (isJsonFile.exec(configFilePath)) {\n    const babelConfigRaw = readFileSync(configFilePath, 'utf8')\n    return JSON5.parse(babelConfigRaw)\n  } else if (isJsFile.exec(configFilePath)) {\n    return require(configFilePath)\n  }\n  throw new Error(\n    'The Next.js Babel loader does not support .mjs or .cjs config files.'\n  )\n}\n\n/**\n * Generate a new, flat Babel config, ready to be handed to Babel-traverse.\n * This config should have no unresolved overrides, presets, etc.\n */\nfunction getFreshConfig(\n  this: NextJsLoaderContext,\n  cacheCharacteristics: CharacteristicsGermaneToCaching,\n  loaderOptions: NextBabelLoaderOptions,\n  target: string,\n  filename: string,\n  inputSourceMap?: object | null\n) {\n  let {\n    isServer,\n    pagesDir,\n    development,\n    hasJsxRuntime,\n    configFile,\n  } = loaderOptions\n\n  // Ensures webpack invalidates the cache for this loader when the config file changes\n  if (configFile) {\n    this.addDependency(configFile)\n  }\n\n  let customConfig: any = configFile\n    ? getCustomBabelConfig(configFile)\n    : undefined\n\n  let options = {\n    babelrc: false,\n    cloneInputAst: false,\n    filename,\n    inputSourceMap: inputSourceMap || undefined,\n\n    // Set the default sourcemap behavior based on Webpack's mapping flag,\n    // but allow users to override if they want.\n    sourceMaps:\n      loaderOptions.sourceMaps === undefined\n        ? this.sourceMap\n        : loaderOptions.sourceMaps,\n\n    // Ensure that Webpack will get a full absolute path in the sourcemap\n    // so that it can properly map the module back to its internal cached\n    // modules.\n    sourceFileName: filename,\n\n    plugins: [\n      ...getPlugins(loaderOptions, cacheCharacteristics),\n      ...(customConfig?.plugins || []),\n    ],\n\n    // target can be provided in babelrc\n    target: isServer ? undefined : customConfig?.target,\n    // env can be provided in babelrc\n    env: customConfig?.env,\n\n    presets: (() => {\n      // If presets is defined the user will have next/babel in their babelrc\n      if (customConfig?.presets) {\n        return customConfig.presets\n      }\n\n      // If presets is not defined the user will likely have \"env\" in their babelrc\n      if (customConfig) {\n        return undefined\n      }\n\n      // If no custom config is provided the default is to use next/babel\n      return ['next/babel']\n    })(),\n\n    overrides: loaderOptions.overrides,\n\n    caller: {\n      name: 'next-babel-turbo-loader',\n      supportsStaticESM: true,\n      supportsDynamicImport: true,\n\n      // Provide plugins with insight into webpack target.\n      // https://github.com/babel/babel-loader/issues/787\n      target: target,\n\n      // Webpack 5 supports TLA behind a flag. We enable it by default\n      // for Babel, and then webpack will throw an error if the experimental\n      // flag isn't enabled.\n      supportsTopLevelAwait: true,\n\n      isServer,\n      pagesDir,\n      isDev: development,\n      hasJsxRuntime,\n\n      ...loaderOptions.caller,\n    },\n  } as any\n\n  // Babel does strict checks on the config so undefined is not allowed\n  if (typeof options.target === 'undefined') {\n    delete options.target\n  }\n\n  Object.defineProperty(options.caller, 'onWarning', {\n    enumerable: false,\n    writable: false,\n    value: (reason: any) => {\n      if (!(reason instanceof Error)) {\n        reason = new Error(reason)\n      }\n      this.emitWarning(reason)\n    },\n  })\n\n  const loadedOptions = loadOptions(options)\n  const config = consumeIterator(loadConfig(loadedOptions))\n\n  return config\n}\n\n/**\n * Each key returned here corresponds with a Babel config that can be shared.\n * The conditions of permissible sharing between files is dependent on specific\n * file attributes and Next.js compiler states: `CharacteristicsGermaneToCaching`.\n */\nfunction getCacheKey(cacheCharacteristics: CharacteristicsGermaneToCaching) {\n  const {\n    isServer,\n    isPageFile,\n    isNextDist,\n    hasModuleExports,\n    fileExt,\n  } = cacheCharacteristics\n\n  const flags =\n    0 |\n    (isServer ? 0b0001 : 0) |\n    (isPageFile ? 0b0010 : 0) |\n    (isNextDist ? 0b0100 : 0) |\n    (hasModuleExports ? 0b1000 : 0)\n\n  return fileExt + flags\n}\n\ntype BabelConfig = any\nconst configCache: Map<any, BabelConfig> = new Map()\n\nexport default function getConfig(\n  this: NextJsLoaderContext,\n  {\n    source,\n    target,\n    loaderOptions,\n    filename,\n    inputSourceMap,\n  }: {\n    source: string\n    loaderOptions: NextBabelLoaderOptions\n    target: string\n    filename: string\n    inputSourceMap?: object | null\n  }\n): BabelConfig {\n  const cacheCharacteristics = getCacheCharacteristics(\n    loaderOptions,\n    source,\n    filename\n  )\n\n  const cacheKey = getCacheKey(cacheCharacteristics)\n  if (configCache.has(cacheKey)) {\n    const cachedConfig = configCache.get(cacheKey)\n\n    return {\n      ...cachedConfig,\n      options: {\n        ...cachedConfig.options,\n        cwd: loaderOptions.cwd,\n        root: loaderOptions.cwd,\n        filename,\n        sourceFileName: filename,\n      },\n    }\n  }\n\n  const freshConfig = getFreshConfig.call(\n    this,\n    cacheCharacteristics,\n    loaderOptions,\n    target,\n    filename,\n    inputSourceMap\n  )\n\n  configCache.set(cacheKey, freshConfig)\n\n  return freshConfig\n}\n"]}